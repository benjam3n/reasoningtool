---
interface Props {
  activeNav?: string;
}
const { activeNav = '' } = Astro.props;

const links = [
  { href: '/essays', label: 'Essays', id: 'essays' },
  { href: '/skills', label: 'Skills', id: 'skills' },
  { href: '/tools', label: 'Tools', id: 'tools' },
  { href: '/getting-started', label: 'Get Started', id: 'getting-started' },
  { href: '/about', label: 'About', id: 'about' },
  { href: 'https://github.com/benjam3n/reasoningtool', label: 'GitHub', id: 'github' },
];
---

<nav class="nav">
  <div class="nav__inner">
    <a href="/" class="nav__brand">reasoningtool</a>
    <ul class="nav__links">
      {links.map(link => (
        <li>
          <a
            href={link.href}
            class:list={[{ active: activeNav === link.id }]}
            {...(link.id === 'github' ? { target: '_blank', rel: 'noopener' } : {})}
          >{link.label}</a>
        </li>
      ))}
      <li>
        <button class="nav__theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
          <span id="theme-icon">&#9790;</span>
        </button>
      </li>
    </ul>
  </div>
</nav>

<script is:inline>
  (function() {
    const stored = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = stored || (prefersDark ? 'dark' : 'light');
    if (stored) document.documentElement.setAttribute('data-theme', theme);

    function updateIcon() {
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark' ||
        (!document.documentElement.getAttribute('data-theme') && prefersDark);
      const icon = document.getElementById('theme-icon');
      if (icon) icon.textContent = isDark ? '\u2600' : '\u263E';
    }

    document.addEventListener('DOMContentLoaded', function() {
      updateIcon();
      document.getElementById('theme-toggle')?.addEventListener('click', function() {
        const current = document.documentElement.getAttribute('data-theme');
        const isDark = current === 'dark' || (!current && prefersDark);
        const next = isDark ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        updateIcon();
      });
    });
  })();
</script>
