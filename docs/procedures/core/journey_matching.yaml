# Journey Matching Procedure
# Find applicable journeys for a current situation

id: journey_matching
name: Journey Matching
version: "1.0.0"
domain: core

description: |
  Given a current situation (goal, problem, state), find journeys
  from the library that might apply. This enables learning from
  past patterns without reinventing every path.

core_insight: |
  Most situations have been navigated before - just in different specifics.
  Journey matching finds the abstract patterns that transfer.

  Not: "Someone else did exactly this"
  But: "Someone navigated a structurally similar situation"

# ============================================
# INPUTS
# ============================================

inputs:
  required:
    current_state: "Where you are now"
    desired_state: "Where you want to be (if known)"

  optional:
    constraints: "What limits the path"
    past_attempts: "What's been tried"
    archetype_hints: "What type of journey you think this is"

# ============================================
# MATCHING STEPS
# ============================================

steps:
  - id: 1
    name: "Characterize the situation"
    action: |
      Describe the current situation in semi-generalizable terms.

      Avoid specifics:
      NOT: "I'm a 35-year-old software engineer at BigCorp wanting to start a fintech startup"
      BUT: "Person in established career seeking entrepreneurial transition in technical domain"

      Capture:
      - Current state (what is)
      - Desired state (what's sought) - if known
      - Gap type (what kind of change is needed)
      - Constraints (what limits options)

    output: situation_characterization

  - id: 2
    name: "Identify archetype dimensions"
    action: |
      Estimate the journey archetype:

      Complexity:
      - Simple: Direct path likely exists
      - Complicated: Multiple clear steps needed
      - Complex: Path will emerge through action
      - Chaotic: Survival mode, stabilize first

      Difficulty:
      - Easy: Resources exceed requirements
      - Challenging: Will require effort and growth
      - Hard: Requirements exceed apparent resources
      - Seemingly impossible: No obvious path

      Predictability:
      - Predictable: Know the general shape
      - Has twist: Expect unexpected turn
      - Reversal possible: May discover opposite goal
      - Emergent: Destination unclear

      Frequency:
      - Universal: Nearly everyone faces this
      - Common: Many face this
      - Uncommon: Specific circumstances
      - Rare: Few face this

    output: archetype_estimate

  - id: 3
    name: "Identify domain and themes"
    action: |
      What domain(s) does this situation belong to?

      Domains:
      - Personal growth
      - Career / professional
      - Relationship / social
      - Creative / artistic
      - Entrepreneurial / business
      - Learning / skill development
      - Health / wellbeing
      - Spiritual / meaning
      - Financial
      - Technical / problem-solving

      What themes are present?

      Themes:
      - Transition (leaving one thing for another)
      - Growth (becoming more capable)
      - Recovery (returning from setback)
      - Discovery (finding what's unknown)
      - Creation (making something new)
      - Connection (building relationships)
      - Liberation (escaping constraints)
      - Mastery (achieving excellence)
      - Transformation (becoming different)
      - Resolution (ending conflict)

    output: domain_and_themes

  - id: 4
    name: "Search journey library"
    action: |
      Search for matching journeys:

      Primary match criteria:
      1. Archetype similarity (complexity, difficulty match)
      2. Domain overlap
      3. Theme alignment
      4. Starting state similarity
      5. Desired state similarity (if known)

      Search strategy:
      1. Exact archetype match + domain match
      2. Partial archetype match + domain match
      3. Archetype match + theme match (cross-domain)
      4. Theme match only (broadest)

      For each candidate:
      - Why might this apply?
      - What's similar?
      - What's different?

    output: candidate_journeys

  - id: 5
    name: "Evaluate fit"
    action: |
      For each candidate journey, assess fit:

      Structural fit:
      - Does the starting state match?
      - Does the destination (if specified) match?
      - Do the constraints align?
      - Are the transitions relevant?

      Resonance fit:
      - Does this feel like "my situation"?
      - Do the steps make sense for my context?
      - Would I recognize this as my potential path?

      Transfer feasibility:
      - Can the steps actually be instantiated?
      - Are there blockers to this path?
      - What would need to be true for this to work?

      Score each journey: Strong fit / Moderate fit / Weak fit / No fit

    output: fit_assessments

  - id: 6
    name: "Identify current position"
    action: |
      For each fitting journey:

      Where in the journey are you now?
      - Before the journey starts?
      - At step N?
      - Between steps?
      - Near the end?

      This tells you:
      - What typically comes next
      - What others experienced at this point
      - What challenges to expect

    output: position_in_journeys

  - id: 7
    name: "Generate guidance"
    action: |
      For top-matching journeys, generate guidance:

      What this journey suggests:
      - Typical next steps
      - Common challenges at this stage
      - Key transitions to prepare for
      - What success looks like from here
      - What failure modes to watch for

      Variations to consider:
      - What if your path differs?
      - Alternative routes others have taken
      - What makes your situation unique

      Confidence level:
      - Strong match: High confidence in guidance
      - Moderate match: Consider this, but adapt
      - Weak match: Inspiration only, don't follow literally

    output: journey_guidance

  - id: 8
    name: "Synthesize recommendations"
    action: |
      Combine insights from all matching journeys:

      Convergent patterns:
      - What do multiple journeys agree on?
      - What steps appear in most matches?
      - What transitions are universally important?

      Divergent options:
      - Where do journeys differ?
      - What alternative paths exist?
      - Which divergences matter for your situation?

      Synthesized guidance:
      - Most likely path based on matches
      - Alternative paths to consider
      - Key decision points ahead
      - What to watch for

    output: synthesized_recommendations

# ============================================
# OUTPUT FORMAT
# ============================================

output_format:
  situation_summary:
    current_state: "[Semi-generalized description]"
    desired_state: "[If known]"
    archetype:
      complexity: "[simple|complicated|complex|chaotic]"
      difficulty: "[easy|challenging|hard|seemingly_impossible]"
    domains: ["domain1", "domain2"]
    themes: ["theme1", "theme2"]

  top_matching_journeys:
    - journey:
        title: "[Journey name]"
        source: "[Original source]"
        fit: "[Strong|Moderate|Weak]"
        why_matches: "[Explanation]"
      your_position:
        current_step: N
        description: "[Where you are in this journey]"
      guidance:
        next_steps: ["Step 1", "Step 2"]
        watch_for: ["Challenge 1", "Challenge 2"]
        key_transition: "[Upcoming crucial moment]"

  synthesis:
    convergent_patterns:
      - "[Pattern that multiple journeys agree on]"
    divergent_options:
      - "[Option 1: from journey A]"
      - "[Option 2: from journey B]"
    recommended_path:
      steps: ["Step 1", "Step 2", "..."]
      confidence: "[High|Medium|Low]"
      reasoning: "[Why this path]"
    alternatives:
      - path: ["Alt step 1", "..."]
        when_to_use: "[Condition]"

# ============================================
# WHEN NO MATCHES FOUND
# ============================================

no_matches:
  description: |
    If no journeys match, you may be facing:
    1. A genuinely novel situation (rare)
    2. A situation not yet captured in the library
    3. A mis-characterized situation (try different framing)

  actions:
    try_reframing:
      - Generalize further (maybe too specific)
      - Try different archetypes
      - Try different domains/themes

    proceed_without:
      - Document this as a potential new journey
      - Use general principles instead of specific journey
      - After completion, extract and add to library

    seek_sources:
      - What sources might contain similar journeys?
      - Who has navigated something like this?
      - What domains have structural similarities?

# ============================================
# EXAMPLES
# ============================================

examples:
  example_1:
    situation:
      current_state: "Person with stable job, considering entrepreneurship"
      desired_state: "Running successful own business"
      constraints: "Limited savings, family responsibilities"

    characterization:
      semi_general: "Person in security-providing position seeking transition to uncertainty-embracing position with resource constraints"
      archetype:
        complexity: complicated
        difficulty: hard
        predictability: twist (likely pivots)
      domains: [career, entrepreneurial]
      themes: [transition, creation, liberation]

    matches:
      - journey: "Unfulfillment to entrepreneurial success through pivot"
        fit: Strong
        why: "Same transition type, similar constraints"
        position: "Before step 3 (leaving security)"
        guidance:
          next: "Validate idea before leaving"
          watch_for: "First version will likely fail"
          key_transition: "Decision to persist after failure"

      - journey: "Parallel path building before leap"
        fit: Moderate
        why: "Alternative approach - build while employed"
        position: "At step 1 (side project while employed)"
        guidance:
          next: "Create minimum viable effort while keeping job"
          watch_for: "Time management, energy depletion"

    synthesis:
      convergent: "Both suggest validation before full commitment"
      divergent: "Leap vs parallel building"
      recommended: "Parallel building given family constraints"

  example_2:
    situation:
      current_state: "Person struggling to learn complex skill"
      desired_state: "Competence in the skill"
      past_attempts: "Tried intensive bootcamp, got lost"

    characterization:
      semi_general: "Person with learning goal, fast approach failed"
      archetype:
        complexity: complicated
        difficulty: challenging
        predictability: twist (initial approach wrong)
      domains: [learning, personal_growth]
      themes: [mastery, growth]

    matches:
      - journey: "Retreat to advance learning path"
        fit: Strong
        why: "Exactly matches - fast approach failed"
        position: "At step 4 (just realized need fundamentals)"
        guidance:
          next: "Step back to basics, build foundation"
          watch_for: "Frustration at 'going backward'"
          key_transition: "When to return to advanced"

    synthesis:
      recommended: "Retreat to fundamentals, then advance"
      confidence: High

# ============================================
# INTEGRATION
# ============================================

integration:
  with_goal_structure_reconstruction:
    description: |
      After reconstructing the goal-structure, use journey matching
      to find patterns that fit that structure.

      Goal-structure gives: what goals are being served
      Journey matching gives: what paths others have taken

  with_planning:
    description: |
      Journey matching informs planning:
      - What phases to expect
      - What challenges are common
      - What adaptation points exist

  with_execution:
    description: |
      During execution, journey matching helps:
      - "This is normal for step N"
      - "This challenge is expected"
      - "Others pivoted here"
